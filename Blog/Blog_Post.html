<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>@font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}

body {
    width: 980px;
    margin-right: auto;
    margin-left: auto;
    color:#333;
    background:#fff;
}

body .markdown-body {
    padding: 45px;
    word-wrap: break-word;
}

.markdown-body .octicon-link:before {
  font: normal normal normal 16px/1 octicons-link;
  display: inline-block;
  text-decoration: none;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  content: '\f05c';
  vertical-align: middle;
}

.markdown-body .anchor {
  float: left;
  line-height: 1;
  margin-left: -20px;
  padding-right: 4px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #24292e;
  line-height: 1.5;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #032f62;
}

.markdown-body .pl-smw,
.markdown-body .pl-v {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  background-color: #b31d28;
  color: #fafbfc;
}

.markdown-body .pl-c2 {
  background-color: #d73a49;
  color: #fafbfc;
}

.markdown-body .pl-c2:before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  color: #22863a;
  font-weight: 700;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #005cc5;
  font-weight: 700;
}

.markdown-body .pl-mi {
  color: #24292e;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #24292e;
  font-weight: 700;
}

.markdown-body .pl-md {
  background-color: #ffeef0;
  color: #b31d28;
}

.markdown-body .pl-mi1 {
  background-color: #f0fff4;
  color: #22863a;
}

.markdown-body .pl-mc {
  background-color: #ffebda;
  color: #e36209;
}

.markdown-body .pl-mi2 {
  background-color: #005cc5;
  color: #f6f8fa;
}

.markdown-body .pl-mdr {
  color: #6f42c1;
  font-weight: 700;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  color: #032f62;
  text-decoration: underline;
}

.markdown-body details {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body strong {
  font-weight: inherit;
  font-weight: bolder;
}

.markdown-body h1 {
  font-size: 2em;
  margin: .67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace,monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type=checkbox] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: #0366d6;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
}

.markdown-body hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

.markdown-body hr:before {
  content: "";
  display: table;
}

.markdown-body hr:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body h1 {
  font-size: 32px;
}

.markdown-body h1,
.markdown-body h2 {
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
}

.markdown-body h3 {
  font-size: 20px;
}

.markdown-body h3,
.markdown-body h4 {
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
}

.markdown-body h5 {
  font-size: 14px;
}

.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
}

.markdown-body p {
  margin-bottom: 10px;
  margin-top: 0;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ol,
.markdown-body ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ol ol ol,
.markdown-body ol ul ol,
.markdown-body ul ol ol,
.markdown-body ul ul ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre {
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body input::-webkit-inner-spin-button,
.markdown-body input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

.markdown-body .border {
  border: 1px solid #e1e4e8!important;
}

.markdown-body .border-0 {
  border: 0!important;
}

.markdown-body .border-bottom {
  border-bottom: 1px solid #e1e4e8!important;
}

.markdown-body .rounded-1 {
  border-radius: 3px!important;
}

.markdown-body .bg-white {
  background-color: #fff!important;
}

.markdown-body .bg-gray-light {
  background-color: #fafbfc!important;
}

.markdown-body .text-gray-light {
  color: #6a737d!important;
}

.markdown-body .mb-0 {
  margin-bottom: 0!important;
}

.markdown-body .my-2 {
  margin-bottom: 8px!important;
  margin-top: 8px!important;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .py-0 {
  padding-bottom: 0!important;
  padding-top: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .py-2 {
  padding-bottom: 8px!important;
  padding-top: 8px!important;
}

.markdown-body .pl-3,
.markdown-body .px-3 {
  padding-left: 16px!important;
}

.markdown-body .px-3 {
  padding-right: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .f6 {
  font-size: 12px!important;
}

.markdown-body .lh-condensed {
  line-height: 1.25!important;
}

.markdown-body .text-bold {
  font-weight: 600!important;
}

.markdown-body:before {
  content: "";
  display: table;
}

.markdown-body:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body>:first-child {
  margin-top: 0!important;
}

.markdown-body>:last-child {
  margin-bottom: 0!important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body blockquote,
.markdown-body dl,
.markdown-body ol,
.markdown-body p,
.markdown-body pre,
.markdown-body table,
.markdown-body ul {
  margin-bottom: 16px;
  margin-top: 0;
}

.markdown-body hr {
  background-color: #e1e4e8;
  border: 0;
  height: .25em;
  margin: 24px 0;
  padding: 0;
}

.markdown-body blockquote {
  border-left: .25em solid #dfe2e5;
  color: #6a737d;
  padding: 0 1em;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 16px;
  margin-top: 24px;
}

.markdown-body h1 {
  font-size: 2em;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: 1px solid #eaecef;
  padding-bottom: .3em;
}

.markdown-body h2 {
  font-size: 1.5em;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: .875em;
}

.markdown-body h6 {
  color: #6a737d;
  font-size: .85em;
}

.markdown-body ol,
.markdown-body ul {
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ol ul,
.markdown-body ul ol,
.markdown-body ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

.markdown-body dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
  width: 100%;
}

.markdown-body table th {
  font-weight: 600;
}

.markdown-body table td,
.markdown-body table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.markdown-body img {
  background-color: #fff;
  box-sizing: content-box;
  max-width: 100%;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: .2em .4em;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

.markdown-body pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

.markdown-body .commit-tease-sha {
  color: #444d56;
  display: inline-block;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 90%;
}

.markdown-body .blob-wrapper {
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  overflow-x: auto;
  overflow-y: hidden;
}

.markdown-body .blob-wrapper-embedded {
  max-height: 240px;
  overflow-y: auto;
}

.markdown-body .blob-num {
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  color: rgba(27,31,35,.3);
  cursor: pointer;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  line-height: 20px;
  min-width: 50px;
  padding-left: 10px;
  padding-right: 10px;
  text-align: right;
  user-select: none;
  vertical-align: top;
  white-space: nowrap;
  width: 1%;
}

.markdown-body .blob-num:hover {
  color: rgba(27,31,35,.6);
}

.markdown-body .blob-num:before {
  content: attr(data-line-number);
}

.markdown-body .blob-code {
  line-height: 20px;
  padding-left: 10px;
  padding-right: 10px;
  position: relative;
  vertical-align: top;
}

.markdown-body .blob-code-inner {
  color: #24292e;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  overflow: visible;
  white-space: pre;
  word-wrap: normal;
}

.markdown-body .pl-token.active,
.markdown-body .pl-token:hover {
  background: #ffea7f;
  cursor: pointer;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.markdown-body .tab-size[data-tab-size="1"] {
  -moz-tab-size: 1;
  tab-size: 1;
}

.markdown-body .tab-size[data-tab-size="2"] {
  -moz-tab-size: 2;
  tab-size: 2;
}

.markdown-body .tab-size[data-tab-size="3"] {
  -moz-tab-size: 3;
  tab-size: 3;
}

.markdown-body .tab-size[data-tab-size="4"] {
  -moz-tab-size: 4;
  tab-size: 4;
}

.markdown-body .tab-size[data-tab-size="5"] {
  -moz-tab-size: 5;
  tab-size: 5;
}

.markdown-body .tab-size[data-tab-size="6"] {
  -moz-tab-size: 6;
  tab-size: 6;
}

.markdown-body .tab-size[data-tab-size="7"] {
  -moz-tab-size: 7;
  tab-size: 7;
}

.markdown-body .tab-size[data-tab-size="8"] {
  -moz-tab-size: 8;
  tab-size: 8;
}

.markdown-body .tab-size[data-tab-size="9"] {
  -moz-tab-size: 9;
  tab-size: 9;
}

.markdown-body .tab-size[data-tab-size="10"] {
  -moz-tab-size: 10;
  tab-size: 10;
}

.markdown-body .tab-size[data-tab-size="11"] {
  -moz-tab-size: 11;
  tab-size: 11;
}

.markdown-body .tab-size[data-tab-size="12"] {
  -moz-tab-size: 12;
  tab-size: 12;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 .2em .25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .pl-3 {
  padding-left: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .pl-7 {
  padding-left: 48px!important;
}

.markdown-body .pl-8 {
  padding-left: 64px!important;
}

.markdown-body .pl-9 {
  padding-left: 80px!important;
}

.markdown-body .pl-10 {
  padding-left: 96px!important;
}

.markdown-body .pl-11 {
  padding-left: 112px!important;
}

.markdown-body .pl-12 {
  padding-left: 128px!important;
}
</style><title>P7_03_Blog_Post</title></head><body><article class="markdown-body"><h1><a id="user-content-building-sentiment-analysis-models" class="anchor" aria-hidden="true" href="#building-sentiment-analysis-models"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building Sentiment Analysis models</h1>
<p>Written by: Octave Antoni
Last updated : October 21th, 2022</p>
<h1><a id="user-content-introduction" class="anchor" aria-hidden="true" href="#introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1>
<p>Sentiment Analysis can be very important for companies because it can quickly tell them the impact of
changes they put in place on the opinion of their customers. Social Media platforms such as <strong>Twitter</strong>
are prime candidates for extracting data on the polarity of the public opinion regarding a company.</p>
<p>We used open source labelled Twitter data for this project since our client did not have such data to
provide us.</p>
<p>During this project, our team has identified <strong>3 different methods of analyzing the Sentiments of Twitter
posts</strong>:</p>
<ul>
<li>
<p>A <strong>Basic Sentiment Analysis using a Logistic Regression Model</strong> with the Azure Machine Learning Designer
platform</p>
</li>
<li>
<p>An <strong>API-based approach</strong> using Microsoft Azure Cognitive Services API</p>
</li>
<li>
<p>An <strong>Advanced Approach using a BERT model</strong> coupled with a Recurrent Neural Network (RNN)</p>
</li>
</ul>
<p>NB : The code for this project is freely available <a href="https://github.com/Faskill/Twitter-Sentiment-Analysis">on Github</a>
for readers wanting additional details. We will try to keep the code as short as possible on the blog post to
underline important decisions.</p>
<h2><a id="user-content-1-basic-sentiment-analysis-using-azure-ml-designer" class="anchor" aria-hidden="true" href="#1-basic-sentiment-analysis-using-azure-ml-designer"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. Basic Sentiment Analysis using Azure ML Designer</h2>
<p>Azure Machine Learning Studio provides a built in Designer platform allowing us to build code-free ML models.
On the left panel of Microsoft Azure Machine Learning Studio, select <strong>Desginer</strong> to get started :</p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Designer.PNG"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Designer.PNG" alt="Designer Button" style="max-width: 100%;"></a></p>
<p>What's interesting is that there are sample machine learning flows that you can select from.</p>
<p>For this project, we <strong>built our own classification flow</strong> :</p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic.PNG"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic.PNG" alt="Designer Classification Flow" style="max-width: 100%;"></a></p>
<p>As you can see in the flow, it was necessary to <strong>split the dataset twice</strong> because our compute instance
was <strong>not able to handle our 1.6million row</strong> dataset. We then performed bigram feature hashing on our
text data before training our Logistic Regression Model.</p>
<p>Here are the results :</p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic_ROC.png"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic_ROC.png" alt="Basic ROC" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic_accuracy.png"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/Basic_accuracy.png" alt="Basic Accuracy" style="max-width: 100%;"></a></p>
<p>The <strong>accuracy for this Basic Sentiment Analysis is quite low at 0.67</strong>, so we wouldn't advise actually
using this in production, although it might be possible to improve the performance of the model by
changing the embedding technique or selecting a more advanced classification model.</p>
<h2><a id="user-content-2-azure-cognitive-service-api-sentiment-analysis" class="anchor" aria-hidden="true" href="#2-azure-cognitive-service-api-sentiment-analysis"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Azure Cognitive Service API Sentiment Analysis</h2>
<p>Using the Azure Cognitive Service API is straightforward but it requires an Azure account as well as a
dedicated Cognitive Service account.</p>
<p>The use of this service with Python requires to store API credentials in a separate file (called cred.py
in my case).</p>
<p>A <strong>big limitation of this API</strong> is that the number of documents analyzed per request is <strong>limited to 10</strong>.
What's more, <strong>the free tier only enables 5000 requests per month</strong> and additional requests can be costly.</p>
<p>Here is a code example to retrieve sentiment on a dataset of 500 records :</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-s1">azure</span>.<span class="pl-s1">core</span>.<span class="pl-s1">credentials</span> <span class="pl-k">import</span> <span class="pl-v">AzureKeyCredential</span>
<span class="pl-k">from</span> <span class="pl-s1">azure</span>.<span class="pl-s1">ai</span>.<span class="pl-s1">textanalytics</span> <span class="pl-k">import</span> <span class="pl-v">TextAnalyticsClient</span>
<span class="pl-k">import</span> <span class="pl-s1">cred</span>

<span class="pl-s1">credential</span> <span class="pl-c1">=</span> <span class="pl-v">AzureKeyCredential</span>(<span class="pl-s1">cred</span>.<span class="pl-s1">cognitive_credential</span>)
<span class="pl-s1">endpoint</span><span class="pl-c1">=</span><span class="pl-s1">cred</span>.<span class="pl-s1">cognitive_endpoint</span>

<span class="pl-s1">text_analytics_client</span> <span class="pl-c1">=</span> <span class="pl-v">TextAnalyticsClient</span>(<span class="pl-s1">endpoint</span>, <span class="pl-s1">credential</span>)

<span class="pl-s1">text_analytics_client</span>

<span class="pl-s1">results</span> <span class="pl-c1">=</span> []
<span class="pl-s1">labels</span><span class="pl-c1">=</span>[]

<span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">1</span>,<span class="pl-c1">51</span>,<span class="pl-c1">1</span>):
    <span class="pl-s1">k</span> <span class="pl-c1">=</span> <span class="pl-c1">10</span><span class="pl-c1">*</span>(<span class="pl-s1">i</span><span class="pl-c1">-</span><span class="pl-c1">1</span>)
    <span class="pl-s1">l</span> <span class="pl-c1">=</span> <span class="pl-c1">10</span><span class="pl-c1">*</span><span class="pl-s1">i</span>
    <span class="pl-s1">subset</span> <span class="pl-c1">=</span> <span class="pl-s1">sample_df</span>[<span class="pl-s1">k</span>:<span class="pl-s1">l</span>]
    
    <span class="pl-s1">documents</span> <span class="pl-c1">=</span> <span class="pl-s1">subset</span>[<span class="pl-s">"text"</span>]

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">text_analytics_client</span>.<span class="pl-en">analyze_sentiment</span>(<span class="pl-s1">documents</span>.<span class="pl-en">to_list</span>(), <span class="pl-s1">language</span><span class="pl-c1">=</span><span class="pl-s">"en"</span>)
    <span class="pl-s1">result</span> <span class="pl-c1">=</span> [<span class="pl-s1">doc</span> <span class="pl-k">for</span> <span class="pl-s1">doc</span> <span class="pl-c1">in</span> <span class="pl-s1">response</span>]

    <span class="pl-s1">results</span>.<span class="pl-en">append</span>(<span class="pl-s1">result</span>)

    <span class="pl-s1">azure_label</span> <span class="pl-c1">=</span> [<span class="pl-c1">1</span> <span class="pl-k">if</span> <span class="pl-s1">doc</span>.<span class="pl-s1">confidence_scores</span>.<span class="pl-s1">positive</span> <span class="pl-c1">&gt;</span> <span class="pl-s1">doc</span>.<span class="pl-s1">confidence_scores</span>.<span class="pl-s1">negative</span> <span class="pl-k">else</span> <span class="pl-c1">0</span> <span class="pl-k">for</span> <span class="pl-s1">doc</span> <span class="pl-c1">in</span> <span class="pl-s1">result</span>]

    <span class="pl-s1">labels</span>.<span class="pl-en">append</span>(<span class="pl-s1">azure_label</span>)

<span class="pl-s1">flat_labels</span> <span class="pl-c1">=</span> <span class="pl-en">list</span>(<span class="pl-s1">np</span>.<span class="pl-en">concatenate</span>(<span class="pl-s1">labels</span>).<span class="pl-s1">flat</span>)</pre></div>
<p>The results of this API are moderate for our Twitter data, <strong>it reaches an accuracy of 0.76</strong>.</p>
<p>These results are not very good for a paid algorithm that still takes time to run because the number of records
that it can analyze is limited to 10/request, which is why I would not currently advise this method.</p>
<p>It is possible though that this API is more optimized for other kinds of data such as reviews.</p>
<h2><a id="user-content-3-text-classification-using-deep-learning" class="anchor" aria-hidden="true" href="#3-text-classification-using-deep-learning"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. Text Classification using Deep Learning</h2>
<p>We have chosen to use a Recurrent Neural Network (RNN) for this task after analyzing several Research Papers, and especially the <a href="https://arxiv.org/abs/1702.01923v1" rel="nofollow">Comparative Study of CNN and RNN for Natural Language Processing, by Wenpeng Yin, Katharina Kann, Mo Yu and Hinrich Schütze</a></p>
<p>The summary of their findings are presented below :</p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/RNN_CNN_comparison.PNG"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/RNN_CNN_comparison.PNG" alt="RNN and CNN comparison" style="max-width: 100%;"></a></p>
<p>As is obvious, for Sentiment Analysis (SentiC), <strong>RNN are more performant than CNNs</strong>.</p>
<h3><a id="user-content-31-choosing-the-best-text-embedding" class="anchor" aria-hidden="true" href="#31-choosing-the-best-text-embedding"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.1 Choosing the best Text Embedding</h3>
<p>We have tried 2 kinds of embeddings for this project :</p>
<ul>
<li>Text Vectorization using the TextVectorization Kera layer (vocabulary size of 10k words)</li>
<li>BERT Embedding</li>
</ul>
<p><strong>Testing has shown that BERT had higher performance than Text Vectorization on our Deep Learning Models</strong>.</p>
<h3><a id="user-content-32-choosing-the-best-model" class="anchor" aria-hidden="true" href="#32-choosing-the-best-model"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2 Choosing the best Model</h3>
<p>We used 3 kind of models with our dataset :</p>
<ul>
<li>Simple Artificial Neural Network (ANN)</li>
<li>RNN with Long Short Term Memory (LSTM) layer</li>
<li>RNN with Gated Recurrent Unit (GRU) layer</li>
</ul>
<p>The most performant model is the RNN with the GRU layer using BERT embedding, with an <strong>accuracy of 0.796 on the test set</strong>.</p>
<p>We have used the smallest SBERT model (L-2 H-128) for this implementation because of computing limitations, but
we could probably <strong>further increase the accuracy by using a larger and more performant BERT model (such as Large BERT)</strong>.</p>
<p>Here is the implementation :</p>
<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-s1">official</span>.<span class="pl-s1">nlp</span> <span class="pl-k">import</span> <span class="pl-s1">optimization</span>  <span class="pl-c"># to create AdamW optimizer</span>
<span class="pl-k">import</span> <span class="pl-s1">tensorflow_hub</span> <span class="pl-k">as</span> <span class="pl-s1">hub</span>

<span class="pl-c">#Using the most modern large BERT encoder since we have long strings</span>
<span class="pl-s1">text_input</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">layers</span>.<span class="pl-v">Input</span>(<span class="pl-s1">shape</span><span class="pl-c1">=</span>(), <span class="pl-s1">dtype</span><span class="pl-c1">=</span><span class="pl-s1">tf</span>.<span class="pl-s1">string</span>)
<span class="pl-s1">preprocessor</span> <span class="pl-c1">=</span> <span class="pl-s1">hub</span>.<span class="pl-v">KerasLayer</span>(
    <span class="pl-s">"https://tfhub.dev/tensorflow/bert_en_uncased_preprocess/3"</span>, <span class="pl-s1">name</span><span class="pl-c1">=</span><span class="pl-s">"preprocessor"</span>)
<span class="pl-s1">encoder_inputs</span> <span class="pl-c1">=</span> <span class="pl-en">preprocessor</span>(<span class="pl-s1">text_input</span>)
<span class="pl-s1">encoder</span> <span class="pl-c1">=</span> <span class="pl-s1">hub</span>.<span class="pl-v">KerasLayer</span>(
    <span class="pl-s">"https://tfhub.dev/tensorflow/small_bert/bert_en_uncased_L-2_H-128_A-2/2"</span>,
    <span class="pl-s1">trainable</span><span class="pl-c1">=</span><span class="pl-c1">True</span>, <span class="pl-s1">name</span><span class="pl-c1">=</span><span class="pl-s">'BERT_encoder'</span>)
<span class="pl-s1">outputs</span> <span class="pl-c1">=</span> <span class="pl-en">encoder</span>(<span class="pl-s1">encoder_inputs</span>)
<span class="pl-s1">pooled_output</span> <span class="pl-c1">=</span> <span class="pl-s1">outputs</span>[<span class="pl-s">"pooled_output"</span>]      <span class="pl-c"># [batch_size, 1024].</span>
<span class="pl-s1">sequence_output</span> <span class="pl-c1">=</span> <span class="pl-s1">outputs</span>[<span class="pl-s">"sequence_output"</span>]  <span class="pl-c"># [batch_size, seq_length, 1024].</span>

<span class="pl-k">def</span> <span class="pl-en">build_classifier_model</span>():
    <span class="pl-s1">text_input</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">layers</span>.<span class="pl-v">Input</span>(<span class="pl-s1">shape</span><span class="pl-c1">=</span>(), <span class="pl-s1">dtype</span><span class="pl-c1">=</span><span class="pl-s1">tf</span>.<span class="pl-s1">string</span>, <span class="pl-s1">name</span><span class="pl-c1">=</span><span class="pl-s">'text'</span>)
    <span class="pl-s1">encoder_inputs</span> <span class="pl-c1">=</span> <span class="pl-en">preprocessor</span>(<span class="pl-s1">text_input</span>)
    <span class="pl-s1">outputs</span> <span class="pl-c1">=</span> <span class="pl-en">encoder</span>(<span class="pl-s1">encoder_inputs</span>)
    <span class="pl-s1">net</span> <span class="pl-c1">=</span> <span class="pl-s1">outputs</span>[<span class="pl-s">'sequence_output'</span>]
    <span class="pl-s1">net</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">layers</span>.<span class="pl-v">GRU</span>(<span class="pl-c1">200</span>)(<span class="pl-s1">net</span>)
    <span class="pl-s1">net</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">layers</span>.<span class="pl-v">Dropout</span>(<span class="pl-c1">0.3</span>)(<span class="pl-s1">net</span>)
    <span class="pl-s1">net</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">layers</span>.<span class="pl-v">Dense</span>(<span class="pl-c1">1</span>, <span class="pl-s1">activation</span><span class="pl-c1">=</span><span class="pl-c1">None</span>, <span class="pl-s1">name</span><span class="pl-c1">=</span><span class="pl-s">'classifier'</span>)(<span class="pl-s1">net</span>)
    <span class="pl-k">return</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-v">Model</span>(<span class="pl-s1">text_input</span>, <span class="pl-s1">net</span>)

<span class="pl-s1">classifier_model</span> <span class="pl-c1">=</span> <span class="pl-en">build_classifier_model</span>()

<span class="pl-s1">epochs</span><span class="pl-c1">=</span><span class="pl-c1">10</span>

<span class="pl-s1">steps_per_epoch</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">data</span>.<span class="pl-s1">experimental</span>.<span class="pl-en">cardinality</span>(<span class="pl-s1">train_ds</span>).<span class="pl-en">numpy</span>()
<span class="pl-s1">num_train_steps</span> <span class="pl-c1">=</span> <span class="pl-s1">steps_per_epoch</span> <span class="pl-c1">*</span> <span class="pl-s1">epochs</span>
<span class="pl-s1">num_warmup_steps</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-c1">0.1</span><span class="pl-c1">*</span><span class="pl-s1">num_train_steps</span>)

<span class="pl-s1">init_lr</span> <span class="pl-c1">=</span> <span class="pl-c1">3e-5</span>
<span class="pl-s1">optimizer</span> <span class="pl-c1">=</span> <span class="pl-s1">optimization</span>.<span class="pl-en">create_optimizer</span>(<span class="pl-s1">init_lr</span><span class="pl-c1">=</span><span class="pl-s1">init_lr</span>,
                                          <span class="pl-s1">num_train_steps</span><span class="pl-c1">=</span><span class="pl-s1">num_train_steps</span>,
                                          <span class="pl-s1">num_warmup_steps</span><span class="pl-c1">=</span><span class="pl-s1">num_warmup_steps</span>,
                                          <span class="pl-s1">optimizer_type</span><span class="pl-c1">=</span><span class="pl-s">'adamw'</span>)

<span class="pl-s1">loss</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">losses</span>.<span class="pl-v">BinaryCrossentropy</span>(<span class="pl-s1">from_logits</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)
<span class="pl-s1">metrics</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">metrics</span>.<span class="pl-v">BinaryAccuracy</span>()

<span class="pl-s1">classifier_model</span>.<span class="pl-en">compile</span>(<span class="pl-s1">optimizer</span><span class="pl-c1">=</span><span class="pl-s1">optimizer</span>,
                         <span class="pl-s1">loss</span><span class="pl-c1">=</span><span class="pl-s1">loss</span>,
                         <span class="pl-s1">metrics</span><span class="pl-c1">=</span><span class="pl-s1">metrics</span>)
<span class="pl-s1">classifier_model</span>.<span class="pl-en">summary</span>()

<span class="pl-k">import</span> <span class="pl-s1">gc</span>

<span class="pl-s1">checkpoint_filepath</span> <span class="pl-c1">=</span> <span class="pl-s">"tmp_bert_2/cp-{epoch:04d}.ckpt"</span>
<span class="pl-s1">model_checkpoint_callback</span> <span class="pl-c1">=</span> <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">callbacks</span>.<span class="pl-v">ModelCheckpoint</span>(
    <span class="pl-s1">filepath</span><span class="pl-c1">=</span><span class="pl-s1">checkpoint_filepath</span>,
    <span class="pl-s1">save_weights_only</span><span class="pl-c1">=</span><span class="pl-c1">True</span>,
    <span class="pl-s1">verbose</span><span class="pl-c1">=</span><span class="pl-c1">1</span>)

<span class="pl-k">class</span> <span class="pl-v">MemClearCallback</span>(<span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">callbacks</span>.<span class="pl-v">Callback</span>):
    <span class="pl-k">def</span> <span class="pl-en">on_epoch_end</span>(<span class="pl-s1">self</span>, <span class="pl-s1">epoch</span>, <span class="pl-s1">logs</span><span class="pl-c1">=</span><span class="pl-c1">None</span>):
        <span class="pl-s1">tf</span>.<span class="pl-s1">keras</span>.<span class="pl-s1">backend</span>.<span class="pl-en">clear_session</span>() <span class="pl-c">#Resets RAM usage after every EPOCH</span>
        <span class="pl-s1">gc</span>.<span class="pl-en">collect</span>()
        
<span class="pl-s1">mem_clear</span> <span class="pl-c1">=</span> <span class="pl-v">MemClearCallback</span>()

<span class="pl-s1">history_bert</span> <span class="pl-c1">=</span> <span class="pl-s1">classifier_model</span>.<span class="pl-en">fit</span>(<span class="pl-s1">x</span><span class="pl-c1">=</span><span class="pl-s1">train_ds</span>,
                                    <span class="pl-s1">validation_data</span><span class="pl-c1">=</span><span class="pl-s1">val_ds</span>,
                                    <span class="pl-s1">epochs</span><span class="pl-c1">=</span><span class="pl-s1">epochs</span>,
                                    <span class="pl-s1">callbacks</span> <span class="pl-c1">=</span> [<span class="pl-s1">mem_clear</span>, <span class="pl-s1">model_checkpoint_callback</span>]
                                   )</pre></div>
<p>Below are the results of this model :</p>
<p><a target="_blank" rel="noopener noreferrer" href="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/BERT_RNN_GRU_results.png"><img src="/C:/0.%20Files/1.%20WIP/2.%20Data%20Analysis/Openclassrooms/AI%20Engineer/Project%207/Blog/BERT_RNN_GRU_results.png" alt="Results of the BERT RNN (GRU) Model : " style="max-width: 100%;"></a></p>
<h2><a id="user-content-4-conclusion" class="anchor" aria-hidden="true" href="#4-conclusion"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. Conclusion</h2>
<p>We have shown in this project that there are <strong>different methods to implement Sentiment Analysis</strong> using the
Azure Machine Learning Studio platform.</p>
<p>The <strong>best method</strong> is the implementation of a <strong>deep learning model using Azure Machine Learning studio</strong>.</p>
<p>After testing several embedding / model combinations, we have concluded that the <strong>BERT Embedding + Recurrent
Neural Network with a Gated Recurrent Unit (RNN / GRU) is the most performant</strong> for Twitter Review sentiment
analysis.</p>
<p>The model <strong>could be further improved by increasing the number of training epochs</strong> and using a higher-end
computing virtual machine.</p>
</article></body></html>